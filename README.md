# classical-cipher-breaker
This program try to decrypt cryptogram encrypted by classical way, namely shift cipher, substition cipher, and vigenere cipher. 
In decryption of message encrypted by vigenere cipher, we use I.C. (Index of Coincidence) and Mutual I.C.

## Requirements
- Python 3.7


## Usage
Note : You can also excecute this program at https://repl.it/@thanatoth/classical-cipher-breaker. Please fork the project and use it (If you does not have an account of repl.it please create your account). 
Here, you need not construct virtual environment. For execution, remove `pipenv run` from any instructions shown below. For example, if you want to run main.py, what you have to do is excecute `python main.py` at the terminal shown on the left side of this page. 

1. Clone this repository
```bash
$ git clone https://github.com/thanatoth/classical-cipher-breaker.git
$ cd classical-cipher-breake
```

2. Construct virtual environment
```bash
$ pipenv install
```

3. Copy and Paste a cryptogram you want to decrypt to `input/cryptogram.txt`.

4. Execute `main.py`
```bash
$ pipenv run python main.py
```
After excecution, you can see the result of decryption at `output/result.txt`
The file consists of three results: the result by shift cipher solver, substition cipher solver, vigenere cipher solver.
First, if the message you inputted is encrypted by shift cipher, you can find a meaningful text from 26 results. 
The number from 0 to 25 represents the shift key. 

```
Shift
-----------------------------------------------------------
0 : XHWLISAMYALBSNKTWRWVELDXHBQIPALHENVTWVAOMDDRECLXHUHHRBQVSRLXDHSOIAUHQMGGENVBRTWKISLBRGMGHEJECIFZPOYBGNGMMCWMLALMLEKHPDAXVSSKINGMQOLBZALXHTGKITJXETBNWTGKIVWGQAAGPYTRXHWBVRSMMOFTPAKLISKFINLHJTZXHAFZIRKHJBSMXLWTRDTRXHWBVSWEJIFMIRWLXRSMLEJMLEQWMSUHZEJTWOMGHRWTWOFMSRMGEWSRFYJXELASMNYMLALPLALBXMSDISKXRSWYSRLAIMLHHOVXTEFWWOFPLALBXWAEPMSDISWGWEXHVOLAIRKMSDGTRDLAETSEPOXMLEGMLEJLGAFGSTAVITZBWTGHIVWGEQMBXETKEVWLSLVBIRETCPJXJEJMSRMGVALAIRLAENZXVOAVELDRFULISIFMPEKLPYVBITJRMNYMSSLXQTZXSNUHQIFZXIVXELDUCHAFWEDYXHMLAEUHYLVBQAYBREOBXHGNXCGGXRSWMCLBSNSVMRUNQSLTRCWBRWZBGHSGERERELDHJWZHWEEXQBWKWAJXFRSOIFDXISSMXOHLTEWWFEXHVELAIEFXQYETOEKTQONXMFLAISGEHIWKWRWTPLQTVETKEVWMLEFMLIKLYRWECIKGXTZXSULVSMWTRYGYXHWFAAFMIDWTGHOHYLVAEVWIVEXXVRWWXHSMELDLXAFWENVYMGZMAHSMAEZTZEZXVELAINALECSLIIFPLIUAXHWBRTWKECLBSNGYQAFRMNVBZIVNELDRVALBSNSEHEUBWIGGQACBRGHKSCWLWEKHREHKSCWLWPWKWODWMEJIVOVNGEKTROMMGOEXMNLXRDWWFYFHSNWFSSLTVMAXWTJRXOSOSIVMLIKIVOTEIMBNWTSLGOJMIZVBHSAGGELAIYUTRTMLYADECMSDIRWMVESMTHQLMCSEPYAFTOKLMBDXXHWRQACXMTWVSNGFMCSEPYAFTOKLMBDXXHWRWHGHXDWLIRLXVSLAINKMENVBRGSGHFAZLTAGKIKXECZLSLVBIRKBRDAOMDMTPLQKETAHRADVSUJLIOXTGTAHRAXMIRSEPBWVEUKXXHWVSSLHJRMGRIFZMSKNVELHFESMPESLXAKAMGZTWTZXGOKMSFKMEYAGK


1 : WGVKHRZLXZKARMJSVQVUDKCWGAPHOZKGDMUSVUZNLCCQDBKWGTGGQAPURQKWCGRNHZTGPLFFDMUAQSVJHRKAQFLFGDIDBHEYONXAFMFLLBVLKZKLKDJGOCZWURRJHMFLPNKAYZKWGSFJHSIWDSAMVSFJHUVFPZZFOXSQWGVAUQRLLNESOZJKHRJEHMKGISYWGZEYHQJGIARLWKVSQCSQWGVAURVDIHELHQVKWQRLKDILKDPVLRTGYDISVNLFGQVSVNELRQLFDVRQEXIWDKZRLMXLKZKOKZKAWLRCHRJWQRVXRQKZHLKGGNUWSDEVVNEOKZKAWVZDOLRCHRVFVDWGUNKZHQJLRCFSQCKZDSRDONWLKDFLKDIKFZEFRSZUHSYAVSFGHUVFDPLAWDSJDUVKRKUAHQDSBOIWIDILRQLFUZKZHQKZDMYWUNZUDKCQETKHRHELODJKOXUAHSIQLMXLRRKWPSYWRMTGPHEYWHUWDKCTBGZEVDCXWGLKZDTGXKUAPZXAQDNAWGFMWBFFWQRVLBKARMRULQTMPRKSQBVAQVYAFGRFDQDQDKCGIVYGVDDWPAVJVZIWEQRNHECWHRRLWNGKSDVVEDWGUDKZHDEWPXDSNDJSPNMWLEKZHRFDGHVJVQVSOKPSUDSJDUVLKDELKHJKXQVDBHJFWSYWRTKURLVSQXFXWGVEZZELHCVSFGNGXKUZDUVHUDWWUQVVWGRLDKCKWZEVDMUXLFYLZGRLZDYSYDYWUDKZHMZKDBRKHHEOKHTZWGVAQSVJDBKARMFXPZEQLMUAYHUMDKCQUZKARMRDGDTAVHFFPZBAQFGJRBVKVDJGQDGJRBVKVOVJVNCVLDIHUNUMFDJSQNLLFNDWLMKWQCVVEXEGRMVERRKSULZWVSIQWNRNRHULKHJHUNSDHLAMVSRKFNILHYUAGRZFFDKZHXTSQSLKXZCDBLRCHQVLUDRLSGPKLBRDOXZESNJKLACWWGVQPZBWLSVURMFELBRDOXZESNJKLACWWGVQVGFGWCVKHQKWURKZHMJLDMUAQFRFGEZYKSZFJHJWDBYKRKUAHQJAQCZNLCLSOKPJDSZGQZCURTIKHNWSFSZGQZWLHQRDOAVUDTJWWGVURRKGIQLFQHEYLRJMUDKGEDRLODRKWZJZLFYSVSYWFNJLREJLDXZS

:
:
```

Second, if the message you inputted is encrypted by substitution cipher, you might get a meaningful text.
```
Substitute
-----------------------------------------------------------
Keys : {'l': 'e', 'e': 't', 'm': 'a', 'w': 'o', 's': 'i', 'x': 'n', 'a': 's', 'r': 'h', 'h': 'r', 'i': 'd', 't': 'l', 'v': 'c', 'g': 'u', 'k': 'm', 'b': 'w', 'f': 'f', 'o': 'g', 'n': 'y', 'd': 'p', 'y': 'b', 'z': 'v', 'q': 'k', 'p': 'j', 'j': 'x', 'c': 'q', 'u': 'z'}
NROEDISABSEWIYMLOHOCTEPNRWKDJSERTYCLOCSGAPPHTQENRZRRHWKCIHENPRIGDSZRKAUUTYCWHLOMDIEWHUAURTXTQDFVJGBWUYUAAQOAESEAETMRJPSNCIIMDYUAKGEWVSENRLUMDLXNTLWYOLUMDCOUKSSUJBLHNROWCHIAAGFLJSMEDIMFDYERXLVNRSFVDHMRXWIANEOLHPLHNROWCIOTXDFADHOENHIAETXAETKOAIZRVTXLOGAURHOLOGFAIHAUTOIHFBXNTESIAYBAESEJESEWNAIPDIMNHIOBIHESDAERRGCNLTFOOGFJESEWNOSTJAIPDIOUOTNRCGESDHMAIPULHPESTLITJGNAETUAETXEUSFUILSCDLVWOLURDCOUTKAWNTLMTCOEIECWDHTLQJXNXTXAIHAUCSESDHESTYVNCGSCTEPHFZEDIDFAJTMEJBCWDLXHAYBAIIENKLVNIYZRKDFVNDCNTEPZQRSFOTPBNRAESTZRBECWKSBWHTGWNRUYNQUUNHIOAQEWIYICAHZYKIELHQOWHOVWURIUTHTHTEPRXOVROTTNKWOMOSXNFHIGDFPNDIIANGRELTOOFTNRCTESDTFNKBTLGTMLKGYNAFESDIUTRDOMOHOLJEKLCTLMTCOAETFAEDMEBHOTQDMUNLVNIZECIAOLHBUBNROFSSFADPOLURGRBECSTCODCTNNCHOONRIATEPENSFOTYCBAUVASRIASTVLVTVNCTESDYSETQIEDDFJEDZSNROWHLOMTQEWIYUBKSFHAYCWVDCYTEPHCSEWIYITRTZWODUUKSQWHURMIQOEOTMRHTRMIQOEOJOMOGPOATXDCGCYUTMLHGAAUGTNAYENHPOOFBFRIYOFIIELCASNOLXHNGIGIDCAEDMDCGLTDAWYOLIEUGXADVCWRISUUTESDBZLHLAEBSPTQAIPDHOACTIALRKEAQITJBSFLGMEAWPNNROHKSQNALOCIYUFAQITJBSFLGMEAWPNNROHORURNPOEDHENCIESDYMATYCWHUIURFSVELSUMDMNTQVEIECWDHMWHPSGAPALJEKMTLSRHSPCIZXEDGNLULSRHSNADHITJWOCTZMNNROCIIERXHAUHDFVAIMYCTERFTIAJTIENSMSAUVLOLVNUGMAIFMATBSUM
```
The keys are generated based on appeared frequency of each letter in the cryptgram and general text. For example, the first element, `'l' : 'e'` means that the 'l' corresponds 'e'. This implies that the letter 'l' is most appeared in your input cryptgram, and corresponds to 'e' because the 'e' is the most frequently appeared letter in general. 
However, the substition solver sometimes does not work properly because the order of appeared frequency in your cryptgram does not always corresponds the order of appeared frequency in general text. Sorry for your inconvinience. The code will be updated in the future. 

Third, for vigenere cipher, you can find output like this. 
```
Vigenere
-----------------------------------------------------------
[[1, 2, 22, 0.06575579384296092], [1, 4, 15, 0.06649371613052], [2, 1, 4, 0.06575579384296092], [2, 2, 0, 0.06656948493683187], [2, 3, 18, 0.06677773150076358], [2, 4, 19, 0.06467212735434309], [3, 2, 8, 0.06677773150076358], [4, 1, 11, 0.06649371613052], [4, 2, 7, 0.06467212735434309]]
============> Calculate Manually!!
```

Each [i, j, g, IC] means when the difference between two keys a, b are g, the value of the Mutural I.C is IC. 
Each element is ordered from the one whose g is closest to 0.65.
Choose some of the elements and calculate the difference of each key from z_1.

5. [In case the cryptgram may be encrypted by vigenere] Input your calculated results in `input/explorer_vigenere_input.csv`
Based on your calculated results: z_1, z_2 = z_1 + d_2, z_3 = z_1 + d_3, z_4 = z_1 + d_4, ... , z_k = z_1 + d_n, please input each value as the following. 
```
1,0
2,d_2
3,d_3
4,d_4
:
:
k,d_n

```

6. [In case the cryptgram may be encrypted by vigenere] Excecute `explore_vigenere.py`
```bash
$ pipenv run python explore_vigenere.py
```

7. [In case the cryptgram may be encrypted by vigenere] Excecute `explore_vigenere.py`
After excecution, you can see the result of decryption at `output/vigenere_result.txt`
The number from 0 to 25 represents the value of z_1.

```
0 : XLIWIWMXYEXMSRWEWVIGEPPIHFCTPEXSERHEWZMZMHPCEGXIHYTSRFCGSVXIDLEZIEGSQQSRERHMRXIVIWXMRKYRHIVPCMRKPSKMGRSXMGIXLEXXLIWSPHMIVWEVIRSXQSXMZEXIHXSVIXVIEXNYWXSVIZIRQEMRPCFCXLIMVVEXMSREPEWWIWWQIRXSJXLIHERKIVWSJFEXXPIERHFCXLIMVWIPJMRXIVIWXVEXLIVXLICHMWGSZIVEWSYRHVIEWSRXSVYREAECFCVIEPMDMRKXLEXALEXMXQEOIWWIRWIJSVXLIQXSHSHITIRHWSRALEXMXAMPPQEOIWIRWIJSVSXLIVWXSHSERHXLEXEPPSJXLISXLIVWGERRSXMGIXLMWXSSIZIREUYMXIFVEZIWSPHMIVQECTVIJIVXSVYRVEXLIVXLERLIVSMGEPPCFYXTSMRXPIWWPCHMIXVCMRKXSWXIQXLISRGSQMRKXMHIEPPFCLMQWIPJXLYWAIGSYPHMQEKMRIAMXLSYXGSRXVEHMGXMSREGMVGYQWXERGIMRALMGLEREVQCEPPSJALSWIQIQFIVWEVIFVEZIJPIIWEXXSTWTIIHFIJSVIXLIIRIQCQEOIWEQSZIMJXLIWSPHMIVWVIEPPCEVIFVEZIXLIRXLMWWYVIPCMWRXXLISYXGSQIERCSJXLIQAERXIHIEGLASYPHLEZITVIJIVVIHXLEXEPPWXERHERHJMKLXALEXAILEZILIVIXLIRMWEGEWIMRALMGLXLIMRXIVEGXMSRSJQERCMRHMZMHYEPPCVEXMSREPHIGMWMSRQEOMRKTVSGIWWIWSRITVSGIWWTIVWSPHMIVTVSHYGIWERSYXGSQIMRXIRHIHFCRSSRIQSWXEVQMIWXVCXSEZSMHXLMWTVSFPIQNYWXEWGSVXIDHMHWMRGIXLICGERXYWYEPPCQEOIVIXVIEXTLCWMGEPPCMQTSWWMFPIXLICQEOIMXIGSRSQMGEPPCMQTSWWMFPIXLICWLSSXHIWIVXIVWXLIRWXERHMRKERHJMKLXMRKMWIEGLWSPHMIVWMRHMZMHYEPPCVEXMSREPGSYVWISJEGXMSREJXIVEPPFIGEYWIXLIGSWXSJVYRRMRKMWWYVIXSFIEXPIEWXEWLMKLEWXLIGSWXSJWXECMRK


1 : YMJXJXNYZFYNTSXFXWJHFQQJIGDUQFYTFSIFXANANIQDFHYJIZUTSGDHTWYJEMFAJFHTRRTSFSINSYJWJXYNSLZSIJWQDNSLQTLNHSTYNHJYMFYYMJXTQINJWXFWJSTYRTYNAFYJIYTWJYWJFYOZXYTWJAJSRFNSQDGDYMJNWWFYNTSFQFXXJXXRJSYTKYMJIFSLJWXTKGFYYQJFSIGDYMJNWXJQKNSYJWJXYWFYMJWYMJDINXHTAJWFXTZSIWJFXTSYTWZSFBFDGDWJFQNENSLYMFYBMFYNYRFPJXXJSXJKTWYMJRYTITIJUJSIXTSBMFYNYBNQQRFPJXJSXJKTWTYMJWXYTITFSIYMFYFQQTKYMJTYMJWXHFSSTYNHJYMNXYTTJAJSFVZNYJGWFAJXTQINJWRFDUWJKJWYTWZSWFYMJWYMFSMJWTNHFQQDGZYUTNSYQJXXQDINJYWDNSLYTXYJRYMJTSHTRNSLYNIJFQQGDMNRXJQKYMZXBJHTZQINRFLNSJBNYMTZYHTSYWFINHYNTSFHNWHZRXYFSHJNSBMNHMFSFWRDFQQTKBMTXJRJRGJWXFWJGWFAJKQJJXFYYTUXUJJIGJKTWJYMJJSJRDRFPJXFRTAJNKYMJXTQINJWXWJFQQDFWJGWFAJYMJSYMNXXZWJQDNXSYYMJTZYHTRJFSDTKYMJRBFSYJIJFHMBTZQIMFAJUWJKJWWJIYMFYFQQXYFSIFSIKNLMYBMFYBJMFAJMJWJYMJSNXFHFXJNSBMNHMYMJNSYJWFHYNTSTKRFSDNSINANIZFQQDWFYNTSFQIJHNXNTSRFPNSLUWTHJXXJXTSJUWTHJXXUJWXTQINJWUWTIZHJXFSTZYHTRJNSYJSIJIGDSTTSJRTXYFWRNJXYWDYTFATNIYMNXUWTGQJROZXYFXHTWYJEINIXNSHJYMJDHFSYZXZFQQDRFPJWJYWJFYUMDXNHFQQDNRUTXXNGQJYMJDRFPJNYJHTSTRNHFQQDNRUTXXNGQJYMJDXMTTYIJXJWYJWXYMJSXYFSINSLFSIKNLMYNSLNXJFHMXTQINJWXNSINANIZFQQDWFYNTSFQHTZWXJTKFHYNTSFKYJWFQQGJHFZXJYMJHTXYTKWZSSNSLNXXZWJYTGJFYQJFXYFXMNLMFXYMJHTXYTKXYFDNSL
:
:
```

## Use Case
Cryptgram you want to decrypt
```
XHWLISAMYALBSNKTWRWVELDXHBQIPALHENVTWVAOMDDRECLXHUHHRBQVSRLXDHSOIAUHQMGGENVBRTWKISLBRGMGHEJECIFZPOYBGNGMMCWMLALMLEKHPDAXVSSKINGMQOLBZALXHTGKITJXETBNWTGKIVWGQAAGPYTRXHWBVRSMMOFTPAKLISKFINLHJTZXHAFZIRKHJBSMXLWTRDTRXHWBVSWEJIFMIRWLXRSMLEJMLEQWMSUHZEJTWOMGHRWTWOFMSRMGEWSRFYJXELASMNYMLALPLALBXMSDISKXRSWYSRLAIMLHHOVXTEFWWOFPLALBXWAEPMSDISWGWEXHVOLAIRKMSDGTRDLAETSEPOXMLEGMLEJLGAFGSTAVITZBWTGHIVWGEQMBXETKEVWLSLVBIRETCPJXJEJMSRMGVALAIRLAENZXVOAVELDRFULISIFMPEKLPYVBITJRMNYMSSLXQTZXSNUHQIFZXIVXELDUCHAFWEDYXHMLAEUHYLVBQAYBREOBXHGNXCGGXRSWMCLBSNSVMRUNQSLTRCWBRWZBGHSGERERELDHJWZHWEEXQBWKWAJXFRSOIFDXISSMXOHLTEWWFEXHVELAIEFXQYETOEKTQONXMFLAISGEHIWKWRWTPLQTVETKEVWMLEFMLIKLYRWECIKGXTZXSULVSMWTRYGYXHWFAAFMIDWTGHOHYLVAEVWIVEXXVRWWXHSMELDLXAFWENVYMGZMAHSMAEZTZEZXVELAINALECSLIIFPLIUAXHWBRTWKECLBSNGYQAFRMNVBZIVNELDRVALBSNSEHEUBWIGGQACBRGHKSCWLWEKHREHKSCWLWPWKWODWMEJIVOVNGEKTROMMGOEXMNLXRDWWFYFHSNWFSSLTVMAXWTJRXOSOSIVMLIKIVOTEIMBNWTSLGOJMIZVBHSAGGELAIYUTRTMLYADECMSDIRWMVESMTHQLMCSEPYAFTOKLMBDXXHWRQACXMTWVSNGFMCSEPYAFTOKLMBDXXHWRWHGHXDWLIRLXVSLAINKMENVBRGSGHFAZLTAGKIKXECZLSLVBIRKBRDAOMDMTPLQKETAHRADVSUJLIOXTGTAHRAXMIRSEPBWVEUKXXHWVSSLHJRMGRIFZMSKNVELHFESMPESLXAKAMGZTWTZXGOKMSFKMEYAGK
```

[Flow3] `input/cryptogram.txt`
```
XHWLISAMYALBSNKTWRWVELDXHBQIPALHENVTWVAOMDDRECLXHUHHRBQVSRLXDHSOIAUHQMGGENVBRTWKISLBRGMGHEJECIFZPOYBGNGMMCWMLALMLEKHPDAXVSSKINGMQOLBZALXHTGKITJXETBNWTGKIVWGQAAGPYTRXHWBVRSMMOFTPAKLISKFINLHJTZXHAFZIRKHJBSMXLWTRDTRXHWBVSWEJIFMIRWLXRSMLEJMLEQWMSUHZEJTWOMGHRWTWOFMSRMGEWSRFYJXELASMNYMLALPLALBXMSDISKXRSWYSRLAIMLHHOVXTEFWWOFPLALBXWAEPMSDISWGWEXHVOLAIRKMSDGTRDLAETSEPOXMLEGMLEJLGAFGSTAVITZBWTGHIVWGEQMBXETKEVWLSLVBIRETCPJXJEJMSRMGVALAIRLAENZXVOAVELDRFULISIFMPEKLPYVBITJRMNYMSSLXQTZXSNUHQIFZXIVXELDUCHAFWEDYXHMLAEUHYLVBQAYBREOBXHGNXCGGXRSWMCLBSNSVMRUNQSLTRCWBRWZBGHSGERERELDHJWZHWEEXQBWKWAJXFRSOIFDXISSMXOHLTEWWFEXHVELAIEFXQYETOEKTQONXMFLAISGEHIWKWRWTPLQTVETKEVWMLEFMLIKLYRWECIKGXTZXSULVSMWTRYGYXHWFAAFMIDWTGHOHYLVAEVWIVEXXVRWWXHSMELDLXAFWENVYMGZMAHSMAEZTZEZXVELAINALECSLIIFPLIUAXHWBRTWKECLBSNGYQAFRMNVBZIVNELDRVALBSNSEHEUBWIGGQACBRGHKSCWLWEKHREHKSCWLWPWKWODWMEJIVOVNGEKTROMMGOEXMNLXRDWWFYFHSNWFSSLTVMAXWTJRXOSOSIVMLIKIVOTEIMBNWTSLGOJMIZVBHSAGGELAIYUTRTMLYADECMSDIRWMVESMTHQLMCSEPYAFTOKLMBDXXHWRQACXMTWVSNGFMCSEPYAFTOKLMBDXXHWRWHGHXDWLIRLXVSLAINKMENVBRGSGHFAZLTAGKIKXECZLSLVBIRKBRDAOMDMTPLQKETAHRADVSUJLIOXTGTAHRAXMIRSEPBWVEUKXXHWVSSLHJRMGRIFZMSKNVELHFESMPESLXAKAMGZTWTZXGOKMSFKMEYAGK
```









